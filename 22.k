p:{x:" "\:x;(b:"on"~x 0;"J"$".."\:'2_'","\:x 1)}

r:p'r:0:`:22.txt

r:r@&{~(|/x[1;;1]<-50)||/x[1;;0]>50}'r

c:101#,101#,101#0b

s:{x[0]+!1+x[1]-x[0]}

/ Q1
(+//){
    {[c;b;x;y;z]
        (c;b;x;y;z);
        .[;;:;b]/[c;(,/)(50+s x),/:\:(,/)(50+s y),/:\:(50+s z)]
    }[x;y 0;y[1;0];y[1;1];y[1;2]]
 }/[c;r]
