c:0:`:10.txt

m:")]}>"!3 57 1197 25137

d:{
    if[(0<#x)&(x@(#x)-1)in")]}>";:x];
    i:e@-1+#e:&~^:x;
    x,:y;
    r:")]}>"?y;
    l:"([{<"@r;
    $[(4>r)&l=x@i;@[x;i,-1+#x;:;" "];x]
 }/'[(#c)#,"";c]

/ Q1
+/0^m@l:{x@-1+#x}'d

/ Q2
/ 5/: -> convert base 5 to base 10
n@_0.5*#n:n@<n:{5/:|1+"([{<"?x@&~^:x}'d@&4=")]}>"?{x@-1+#x}'d
