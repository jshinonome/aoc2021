r:0:`:14.txt
t:*r
m:(*+i)!{(x[0],y;y,x 1)}. 'i:{@[" "\:x;0 2]}'2_r

/ Q1
(|/d)-&/d:#:'={x,1_y}/{(,/)?[y in !x;x y;y]}[m]/[10;1_{(-1#x),y}\t]

/ Q2
c:{(+/){x!2#y}'[x@!y;. y]}[m]/[40;#:'=1_{(-1#x),y}\t]

d:+/'(. c)@=(!c)@'1

/ add initial letter
d[*t]+:1

(|/d)-&/d
