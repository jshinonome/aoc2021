/ Q1
d:#:'=l@<l:"J"$","\:*0:`:07.txt
&/{l:(! x)-y;+/x*@[l;&l<0;-1*]}[d]'{x+!1+y-x}.(!d)@(-1 0) + *& . (.5*+/d)<+\d

/ Q2
m:l!+\l:!|/!d
&/{l:(! x)-y;+/x*m@[l;&l<0;-1*]}[d]'l